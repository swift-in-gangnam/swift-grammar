# 클로저

- 클로저란 일정 기능을 하는 코드를 하나의 블록으로 모아놓은 것

### 클로저의 형태

- 이름이 있으면서 어떤 값도 획득하지 않는 전역함수의 형태
- 이름이 있으면서 다른 함수 내부의 값을 획득할 수 있는 중첩된 함수의 형태
- 이름이 없고 주변 문맥에 따라 값을 획득할 수 있는 축약 문법으로 작성한 형태

### 클로저의 표현

- 클로저는 매개 변수의 반환값의 타입을 문맥을 통해 유추가능, 매개변수와 반환값의 타입 생략
- 클로저에 단 한줄의 표현만 들어있다면 암시적으로 이를 반환 값으로 취급
- 축약된 전달인자 이름을 사용할 수 있다
- 후행 클로저 문법을 사용할 수 있다



## 기본 클로저

**Sorted(by:) 정렬 메서드**

- 클로저를 통해 어떻게 정렬할 것인가에 대한 정보를 받아 처리하고 결괏값을 배열로 돌려준다. 

- 단순히  정렬만 하기 때문에 입력받은 배열의 타입과 크기가 동일하다. 

- 기존의 배열은 변경하지 않고 정렬된 배열은 새로 생성하여 반환

### 기본 클로저 내용을 포함한 sorted(by:) 메서드를 이용한 예시

```swift
public fuc sorted(by areinincreasingorder: (Element, Element)- >Bool) - > [Element]

let names: [String] = ["wizplan", "eric", "mook", "jenny"]

func backwards(first: String, second: String) - > bOOL {
    PRINT("\(first) \(second 비교중")
         return first > second
}
    
    let reversed: [String] = names.sorted(by: backwards)
    print(reversed)   // ["mook", "wizplan", "jenny", "eric"]
    
```

## 후행 클로저

- 클로저가 조금 길어지거나 가독성이 조금 떨어진다 싶을때 사용
- 맨 마지막 전달인자로 전달되는 클로저에만 해당,  전달 인자로 클로저 여러개를 전달할때는 **맨 마지막 클로저만 후행 클로저 사용**

- sorted(by:) 메서드처럼 **단 하나의 클로저만 전달인자로 전달하는 경우에는 소괄호 생략**



## 클로저 표현 간소화



### 문맥을 이용한 타입 유추



- 매개 변수의 타입이나 개수, 반환 타입등이 같아야 전달인자로서 전달 가능
- 전달 인자로 전달하는 클로저를 구현할 때는 매개 변수의 타입이나 반환 값의 타입을 **생략 가능**



```swift
// 클로저의 매개변수 타입과 반환 타입을 생략하여 표현할 수 있습니다.
let reversed: [String] = names.sorted { (first, second) in
                                       return first > second
        
                                      }
```



### 단축 인자 이름

- 의미 없어 보이는 매개  변수 이름이 아닌 간결하게 표현하기 위한 단축 인자 이름 제공
-  $1, $2, $3, $4 등 이런 방식으로 표현
- 단축인자 표현 사용시 키워드 **in** 사용할 필요가 없어 진다.



### 암시적 반환 표현

- 클로저에서는 **return** 키워드  생략 가능
- 클로저가 반환 값을 갖는 클로저이고 클로저 내부의 실행문이 단 한 줄이라면, 암시적으로  그 실행문을 반환 값으로 사용 가능

### 연산자 함수

- 매개 변수의 타입과 반환 타입이 연산자를 구현한 함수의 모양과 동일하다면 **연산자만 표기하더라도 알아서 연산하고 반환**



## 값 획득

- 자신이 정의된 위치의 주변 문맥을 통해 상수나 변수를 **획득** 가능
- 값 획득을 통해 클로저는 주변에 정의한 상수나 변수가 더 이상 존재하지 않더라도 해당 상수나 변수의 값을 자신 내부에서 **참조하거나 수정 가능**



## 클로저는 참조 타입

- 함수나 클로저를 상수나 변수에 할당할 때마다 사실은 상수나 변수에 함수나 클로저의 참조를 설정하는 것

```swift
let incrementByTwo: (()- > Int) = makeIncrementer(forIncrement: 2)
let sameWithIncrementByTwo: (() - > Int) = incrementByTwo

let first: Int = incrementByTwo()   		 // 2
let second: Int = sameWithIncrementByTwo()   // 4
```



## 탈출 클로저

- 함수의 전달인자로 전달한 클로저가 함수 종료 후에 호출될 때 클로저가 함수를 **<u>탈출</u>** 한다고 표현
- 매개 변수 이름의 **콜론(:)** 뒤에 **@escaping** 키워드 사용

- 비동기 작업으로 함수 종료 후에 호출해야 하는 클로저를 사용해야 할때 사용
- 함수 외부에 정의된 변수나 상수에 저장하여 함수가 종료된 후에 사용
- 탈출 클로저에서 값 획득을 위해 **self** 키워드를 사용하여 프로 퍼티 접근 
- 비탈출 클로저는 **self** 키워드를 꼭 사용하지 않아도 된다.



## 자동 클로저

- 함수의 전달인자로 전달하는 표현을 자동으로 변환해주는 클로저

- **전달인자를 갖지 않는다**

- 호출되었을 때 자신이 감싸고 있는 코드의 결괏값을 반환합니다.

- 클로저가 호출 되기 전 까지 클로저 내부의 코드가 동작하지 않는다

- 매개 변수 **@autoclosure** 속성 > 자동 클로저 기능 사용 가능

- **@autoclosure** 속성을 사용하면 **@noescape** 속성도 부여됨

  

# 옵셔널 체이닝과 빠른 종료



## 옵셔널 체이닝

- 옵셔널에 속해 있는 nil일지도 모르는 프로퍼티, 메서드, 서브스크립션 등을 가져오거나 호출할 때 사용 할 수 있는 일련의 과정
- 옵셔널을 반복 사용하여 옵셔널이 자전거 체인처럼 서로 꼬리를 물고 있는 모양이기 때문에 옵셔널 체이닝 이라 부른다.
- 중첩된 옵셔널 중 하나라도 값이 존재하지 않는다면 결과적으로 nil을 반환
- 호출하고 싶은 옵셔널 변수나 정수 뒤에 물음표(**?**)를 붙여 표현
- 옵셔널 체이닝은 값을 할당할 수 있다.
- 메서드와 서브스크립트 호출 가능

## 빠른 종료

- 핵심 키워드는 **guard**
- 예외 사항만을 처리하고 싶을때 **guard** 구문 사용
- Boold 타입의 값으로 guard 구문을 동작시킬 수 있지만, 옵셔널 바인딩 역할도 할 수 있다
- **guard** 구문에서 옵셔널 바인딩된 상수를 guadrd 구문이 실행된 아래 코드부터 함수 내부의 지역상수처럼 사용 가능



# 맵, 필터, 리듀스



## 맵

- 자신을 호출할 때 매개변수로 전달된 함수를 실행하여 그 결과를 다시 반환해주는 함수
- 배열,딕셔너리,세트,옵셔널 등에서 사용
- 맵을 사용시 컨테이너가 담고 있던 각각의 값을 매개 변수를 통해 받은 함수에 적용한 후 다시 컨테이너에 포장하어 반환
- 기존 컨테이너 값은 변겅x , 새로운 컨테이너가 생성되어 반환
- **기존 데이터를 변형 하는데** 많이 사용



## 필터

- **컨테이너 내부의 값을 걸러서 추출**하는 역할을 하는 고차함수
- 새로운 컨테이너에 값을 담아 반환
- 특정 조건에 맞게 걸러내는 역할



## 리듀스

- 컨테이너 내부의 콘텐츠를 하나로 합하는 기능을 실행하는 고차함수
- 배열이라면 배열의 모든 값을 전달인자로 전달받은 클로저의 연산 결과로 합해준다



**리듀스는 두가지 형태로 구현**

1.  리듀스는 클로저가 각 요소를 전달 받아 연산한 후 값을 다음 클로저 실행을 위해 반환하며 컨테이너를 순환하는 형태

```swift
public func( reduce<Result>(_ initialResult: RESULT,
       _ nextPartialResult: (Result, Element) throws -> Result) rethrows - > Result
```

2. 컨테이너를 순환하며 클로저가 실행되지만 클로저가 따로 결괏값을 반환하지 않는 형태

```swift
public func reduce<Result>(into initialResult,
     _ updateAccumulatingResult: (inout Result, Element) throws ->()) rethrows -> Result
```



# 모나드

- 타입을 인자로 받는 타입(특정 타입의 값을 포장)
- 특정 타입의 값을 포장한 것을 반환하는 함수(메서드)가 존재
- 포장된 값을 변환하여 같은 형태로 포장하는 함수(메서드)가 존재



## 컨텍스트



- '맥락','전후 사정' 등의 사전적의미로 콘텐츠를 담은 그 무엇인가를 뜻한다.
- optional은 wrapped 타입을 인자로 받는 (제네릭)타입
- 다른 타입의 값을 갖는 상태의 컨텍스트 생성

